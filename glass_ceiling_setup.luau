-- Kanata Maze ã‚¬ãƒ©ã‚¹å¤©äº•ã‚·ã‚¹ãƒ†ãƒ ï¼ˆè‡ªç„¶å…‰å°å…¥ç‰ˆï¼‰
print("ğŸªŸ ã‚¬ãƒ©ã‚¹å¤©äº•ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­ç½®ä¸­...")

local workspace = game:GetService("Workspace")
local Lighting = game:GetService("Lighting")

-- MazeGameãƒ•ã‚©ãƒ«ãƒ€ã®å–å¾—
local mazeGame = workspace:FindFirstChild("MazeGame")
if not mazeGame then
    warn("âŒ MazeGameãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
    return
end

-- æ—¢å­˜ã®å¤©äº•ã‚’å‰Šé™¤
local existingCeiling = mazeGame:FindFirstChild("Ceiling")
if existingCeiling then
    existingCeiling:Destroy()
    print("ğŸ—‘ï¸ æ—¢å­˜ã®å¤©äº•ã‚’å‰Šé™¤ã—ã¾ã—ãŸ")
end

-- æ–°ã—ã„ã‚¬ãƒ©ã‚¹å¤©äº•ãƒ•ã‚©ãƒ«ãƒ€
local glassCeilingFolder = Instance.new("Folder")
glassCeilingFolder.Name = "GlassCeiling"
glassCeilingFolder.Parent = mazeGame

-- ç’°å¢ƒå…‰è¨­å®šã‚’è‡ªç„¶å…‰é‡è¦–ã«èª¿æ•´
Lighting.Ambient = Color3.new(0.8, 0.8, 0.9)  -- æ˜ã‚‹ã„è‡ªç„¶å…‰
Lighting.Brightness = 4  -- ã‚ˆã‚Šæ˜ã‚‹ã
Lighting.OutdoorAmbient = Color3.new(0.9, 0.9, 1)  -- è‡ªç„¶ãªå±‹å¤–å…‰
Lighting.ColorShift_Bottom = Color3.new(0.7, 0.7, 0.8)
Lighting.ColorShift_Top = Color3.new(1, 1, 1)
Lighting.ShadowSoftness = 0.2  -- æŸ”ã‚‰ã‹ã„å½±

-- æ™‚åˆ»ã‚’æ˜¼é–“ã«è¨­å®šï¼ˆè‡ªç„¶å…‰ã‚’æœ€å¤§åŒ–ï¼‰
Lighting.TimeOfDay = "12:00:00"  -- æ­£åˆ
Lighting.GeographicLatitude = 0  -- èµ¤é“ï¼ˆå¤ªé™½ãŒçœŸä¸Šï¼‰

-- ã‚¬ãƒ©ã‚¹ãƒ‘ãƒãƒ«ä½œæˆé–¢æ•°
local function createGlassPanel(position, size)
    local glassPanel = Instance.new("Part")
    glassPanel.Name = "GlassPanel"
    glassPanel.Size = size
    glassPanel.Position = position
    glassPanel.Anchored = true
    glassPanel.CanCollide = true  -- å¤©äº•ã¨ã—ã¦æ©Ÿèƒ½
    glassPanel.Material = Enum.Material.Glass
    glassPanel.BrickColor = BrickColor.new("Institutional white")
    glassPanel.Transparency = 0.1  -- ã»ã¼é€æ˜ï¼ˆã‚ãšã‹ã«è¦‹ãˆã‚‹ï¼‰
    glassPanel.Reflectance = 0.1  -- å°‘ã—ã®åå°„
    glassPanel.Parent = glassCeilingFolder
    
    return glassPanel
end

-- å¤§å‹ã‚¬ãƒ©ã‚¹ãƒ‘ãƒãƒ«ã§è¿·è·¯å…¨ä½“ã‚’ã‚«ãƒãƒ¼
print("ğŸªŸ è¿·è·¯ã‚¨ãƒªã‚¢ã«ã‚¬ãƒ©ã‚¹å¤©äº•ã‚’è¨­ç½®ä¸­...")

-- è¿·è·¯ã‚¨ãƒªã‚¢ï¼ˆ186x150ã‚¹ã‚¿ãƒƒãƒ‰ï¼‰ã‚’ã‚«ãƒãƒ¼ã™ã‚‹å¤§å‹ã‚¬ãƒ©ã‚¹ãƒ‘ãƒãƒ«
local mazeGlassWidth = 200  -- è¿·è·¯ã‚ˆã‚Šå°‘ã—å¤§ãã
local mazeGlassHeight = 160
local panelSize = 20  -- 1ãƒ‘ãƒãƒ«ã®ã‚µã‚¤ã‚º

local glassCount = 0
for x = -mazeGlassWidth/2, mazeGlassWidth/2, panelSize do
    for z = -mazeGlassHeight/2, mazeGlassHeight/2, panelSize do
        local glassPos = Vector3.new(x, 42, z)  -- å¤©äº•ã®é«˜ã•
        createGlassPanel(glassPos, Vector3.new(panelSize, 2, panelSize))
        glassCount = glassCount + 1
    end
end

print("ğŸªŸ è¿·è·¯ã‚¨ãƒªã‚¢ã«ã‚¬ãƒ©ã‚¹ãƒ‘ãƒãƒ« " .. glassCount .. " æšã‚’è¨­ç½®")

-- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢ã®ã‚¬ãƒ©ã‚¹å¤©äº•
print("ğŸªŸ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢ã«ã‚¬ãƒ©ã‚¹å¤©äº•ã‚’è¨­ç½®ä¸­...")
for x = -50, 50, panelSize do
    for z = -140, -80, panelSize do
        local glassPos = Vector3.new(x, 42, z)
        createGlassPanel(glassPos, Vector3.new(panelSize, 2, panelSize))
        glassCount = glassCount + 1
    end
end

-- ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ã®ã‚¬ãƒ©ã‚¹å¤©äº•
print("ğŸªŸ ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ã«ã‚¬ãƒ©ã‚¹å¤©äº•ã‚’è¨­ç½®ä¸­...")
for x = -40, 40, panelSize do
    for z = 80, 140, panelSize do
        local glassPos = Vector3.new(x, 42, z)
        createGlassPanel(glassPos, Vector3.new(panelSize, 2, panelSize))
        glassCount = glassCount + 1
    end
end

-- å¤©çª“ï¼ˆã‚¹ã‚«ã‚¤ãƒ©ã‚¤ãƒˆï¼‰ã®è¿½åŠ 
print("â˜€ï¸ å¤©çª“ã‚’è¿½åŠ ä¸­...")
local skylightPositions = {
    Vector3.new(0, 42, 0),      -- è¿·è·¯ä¸­å¤®
    Vector3.new(-50, 42, -25),  -- è¿·è·¯å·¦
    Vector3.new(50, 42, -25),   -- è¿·è·¯å³
    Vector3.new(-50, 42, 25),   -- è¿·è·¯å·¦ä¸‹
    Vector3.new(50, 42, 25),    -- è¿·è·¯å³ä¸‹
    Vector3.new(0, 42, -110),   -- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢
    Vector3.new(0, 42, 110),    -- ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢
}

for _, pos in ipairs(skylightPositions) do
    local skylight = Instance.new("Part")
    skylight.Name = "Skylight"
    skylight.Size = Vector3.new(15, 1, 15)
    skylight.Position = pos
    skylight.Anchored = true
    skylight.CanCollide = false  -- å…‰ã‚’é€šã™ãŸã‚ã«å½“ãŸã‚Šåˆ¤å®šãªã—
    skylight.Material = Enum.Material.ForceField
    skylight.BrickColor = BrickColor.new("Bright blue")
    skylight.Transparency = 0.7
    skylight.Parent = glassCeilingFolder
    
    -- å¤©çª“ã‹ã‚‰ã®å¼·ã„å…‰æº
    local skylightLight = Instance.new("PointLight")
    skylightLight.Color = Color3.new(1, 1, 0.9)  -- è‡ªç„¶ãªç™½è‰²å…‰
    skylightLight.Brightness = 10  -- éå¸¸ã«æ˜ã‚‹ã„
    skylightLight.Range = 100  -- åºƒç¯„å›²
    skylightLight.Parent = skylight
end

-- è‡ªç„¶å…‰ã‚’æ¨¡å€£ã™ã‚‹è¿½åŠ ã®ç’°å¢ƒå…‰æº
print("â˜€ï¸ è‡ªç„¶å…‰æºã‚’è¿½åŠ ä¸­...")
for x = -80, 80, 40 do
    for z = -120, 120, 40 do
        local naturalLight = Instance.new("Part")
        naturalLight.Name = "NaturalLight"
        naturalLight.Size = Vector3.new(1, 1, 1)
        naturalLight.Position = Vector3.new(x, 50, z)  -- ã‚¬ãƒ©ã‚¹å¤©äº•ã‚ˆã‚Šä¸Š
        naturalLight.Anchored = true
        naturalLight.Transparency = 1  -- å®Œå…¨ã«é€æ˜
        naturalLight.CanCollide = false
        naturalLight.Parent = glassCeilingFolder
        
        local sunLight = Instance.new("PointLight")
        sunLight.Color = Color3.new(1, 0.95, 0.8)  -- å¤ªé™½å…‰ã®è‰²
        sunLight.Brightness = 5
        sunLight.Range = 60
        sunLight.Parent = naturalLight
    end
end

-- ã‚¬ãƒ©ã‚¹ã®åå°„åŠ¹æœã‚’è¿½åŠ 
for _, glass in pairs(glassCeilingFolder:GetChildren()) do
    if glass.Name == "GlassPanel" then
        -- ã‚¬ãƒ©ã‚¹ãƒ‘ãƒãƒ«ã«åå°„ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’è¿½åŠ 
        glass.Reflectance = 0.3  -- åå°„ã‚’å¢—åŠ 
        glass.Transparency = 0.05  -- ã‚ãšã‹ã«è¦‹ãˆã‚‹
        
        -- è¡¨é¢ã«å…‰ã®åå°„åŠ¹æœ
        local surfaceLight = Instance.new("SurfaceLight")
        surfaceLight.Face = Enum.NormalId.Bottom  -- ä¸‹å‘ãã«å…‰ã‚’æ”¾ã¤
        surfaceLight.Color = Color3.new(1, 1, 0.9)
        surfaceLight.Brightness = 2
        surfaceLight.Range = 30
        surfaceLight.Parent = glass
    end
end

print("âœ… ã‚¬ãƒ©ã‚¹å¤©äº•ã‚·ã‚¹ãƒ†ãƒ ã®è¨­ç½®å®Œäº†ï¼")
print("ğŸªŸ ã‚¬ãƒ©ã‚¹ãƒ‘ãƒãƒ«: " .. glassCount .. " æš")
print("â˜€ï¸ å¤©çª“: 7å€‹ã®å¤§å‹ã‚¹ã‚«ã‚¤ãƒ©ã‚¤ãƒˆ")
print("ğŸ’¡ è‡ªç„¶å…‰æº: å…¨åŸŸã«é…ç½®")
print("ğŸŒ… ç’°å¢ƒè¨­å®š: æ­£åˆã®è‡ªç„¶å…‰")
print("âœ¨ åå°„åŠ¹æœ: ã‚¬ãƒ©ã‚¹è¡¨é¢ã‹ã‚‰ã®å…‰")
print("")
print("ğŸŒ ã‚¬ãƒ©ã‚¹å¤©äº•ã«ã‚ˆã‚Šè‡ªç„¶å…‰ãŒè¿·è·¯å…¨ä½“ã‚’ç…§ã‚‰ã—ã¾ã™ï¼")