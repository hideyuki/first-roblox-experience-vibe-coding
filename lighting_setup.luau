-- è¿·è·¯ç…§æ˜ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæ¾æ˜ãƒ»ã‚­ãƒ£ãƒ³ãƒ—ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼ï¼‰
print("ğŸ”¥ è¿·è·¯ç…§æ˜ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­ç½®ä¸­...")

local workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")

-- MazeGameãƒ•ã‚©ãƒ«ãƒ€ã®å–å¾—
local mazeGame = workspace:FindFirstChild("MazeGame")
if not mazeGame then
    warn("âŒ MazeGameãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
    return
end

-- ç…§æ˜ãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ
local lightingFolder = mazeGame:FindFirstChild("Lighting")
if lightingFolder then
    lightingFolder:Destroy()
end
lightingFolder = Instance.new("Folder")
lightingFolder.Name = "Lighting"
lightingFolder.Parent = mazeGame

-- æ¾æ˜ä½œæˆé–¢æ•°
local function createTorch(position, parent)
    local torchFolder = Instance.new("Folder")
    torchFolder.Name = "Torch"
    torchFolder.Parent = parent
    
    -- æ¾æ˜ã®æ”¯æŸ±
    local pole = Instance.new("Part")
    pole.Name = "Pole"
    pole.Size = Vector3.new(0.3, 6, 0.3)
    pole.Position = position + Vector3.new(0, 3, 0)
    pole.Anchored = true
    pole.Material = Enum.Material.Wood
    pole.BrickColor = BrickColor.new("Dark orange")
    pole.Parent = torchFolder
    
    -- æ¾æ˜ã®é ­éƒ¨
    local torchHead = Instance.new("Part")
    torchHead.Name = "TorchHead"
    torchHead.Size = Vector3.new(1, 1, 1)
    torchHead.Position = position + Vector3.new(0, 6.5, 0)
    torchHead.Anchored = true
    torchHead.Material = Enum.Material.Neon
    torchHead.BrickColor = BrickColor.new("Bright orange")
    torchHead.Shape = Enum.PartType.Ball
    torchHead.Parent = torchFolder
    
    -- å…‰æº
    local pointLight = Instance.new("PointLight")
    pointLight.Color = Color3.new(1, 0.7, 0.3)  -- æ¸©ã‹ã„ã‚ªãƒ¬ãƒ³ã‚¸è‰²
    pointLight.Brightness = 2
    pointLight.Range = 25
    pointLight.Parent = torchHead
    
    -- ç‚ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
    local fire = Instance.new("Fire")
    fire.Size = 3
    fire.Heat = 5
    fire.Color = Color3.new(1, 0.5, 0)
    fire.SecondaryColor = Color3.new(1, 0, 0)
    fire.Parent = torchHead
    
    -- ã¡ã‚‰ã¤ãã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
    spawn(function()
        while torchHead.Parent do
            local targetBrightness = math.random(15, 25) / 10
            local tween = TweenService:Create(
                pointLight,
                TweenInfo.new(0.5, Enum.EasingStyle.Sine),
                {Brightness = targetBrightness}
            )
            tween:Play()
            wait(0.5)
        end
    end)
    
    return torchFolder
end

-- ã‚­ãƒ£ãƒ³ãƒ—ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼ä½œæˆé–¢æ•°
local function createCampfire(position, parent)
    local campfireFolder = Instance.new("Folder")
    campfireFolder.Name = "Campfire"
    campfireFolder.Parent = parent
    
    -- çŸ³ã®è¼ª
    for i = 1, 8 do
        local angle = (i - 1) * (math.pi * 2 / 8)
        local stone = Instance.new("Part")
        stone.Name = "Stone" .. i
        stone.Size = Vector3.new(1.5, 1, 1.5)
        stone.Position = position + Vector3.new(math.cos(angle) * 3, 0.5, math.sin(angle) * 3)
        stone.Anchored = true
        stone.Material = Enum.Material.Rock
        stone.BrickColor = BrickColor.new("Dark stone grey")
        stone.Shape = Enum.PartType.Block
        
        -- çŸ³ã‚’å°‘ã—å›è»¢
        stone.Rotation = Vector3.new(0, math.deg(angle), 0)
        stone.Parent = campfireFolder
    end
    
    -- è–ª
    for i = 1, 6 do
        local log = Instance.new("Part")
        log.Name = "Log" .. i
        log.Size = Vector3.new(0.8, 0.8, 4)
        log.Position = position + Vector3.new(
            math.random(-15, 15) / 10,
            0.4,
            math.random(-15, 15) / 10
        )
        log.Anchored = true
        log.Material = Enum.Material.Wood
        log.BrickColor = BrickColor.new("Brown")
        log.Rotation = Vector3.new(0, math.random(0, 360), 0)
        log.Parent = campfireFolder
    end
    
    -- ä¸­å¤®ã®ç‚
    local fireBase = Instance.new("Part")
    fireBase.Name = "FireBase"
    fireBase.Size = Vector3.new(2, 0.1, 2)
    fireBase.Position = position + Vector3.new(0, 0.05, 0)
    fireBase.Anchored = true
    fireBase.Material = Enum.Material.Neon
    fireBase.BrickColor = BrickColor.new("Bright red")
    fireBase.Transparency = 0.8
    fireBase.Parent = campfireFolder
    
    -- å¤§ããªå…‰æº
    local pointLight = Instance.new("PointLight")
    pointLight.Color = Color3.new(1, 0.6, 0.2)
    pointLight.Brightness = 3
    pointLight.Range = 40
    pointLight.Parent = fireBase
    
    -- å¤§ããªç‚ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
    local fire = Instance.new("Fire")
    fire.Size = 8
    fire.Heat = 10
    fire.Color = Color3.new(1, 0.4, 0)
    fire.SecondaryColor = Color3.new(1, 0, 0)
    fire.Parent = fireBase
    
    -- ç…™ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
    local smoke = Instance.new("Smoke")
    smoke.Size = 5
    smoke.Opacity = 0.3
    smoke.RiseVelocity = 15
    smoke.Color = Color3.new(0.3, 0.3, 0.3)
    smoke.Parent = fireBase
    
    -- ç‚ã®ã¡ã‚‰ã¤ã
    spawn(function()
        while fireBase.Parent do
            local targetBrightness = math.random(25, 35) / 10
            local tween = TweenService:Create(
                pointLight,
                TweenInfo.new(0.7, Enum.EasingStyle.Sine),
                {Brightness = targetBrightness}
            )
            tween:Play()
            wait(0.7)
        end
    end)
    
    return campfireFolder
end

-- è¿·è·¯ã®å£ã«æ¾æ˜ã‚’è¨­ç½®
local wallsFolder = mazeGame:FindFirstChild("Walls")
if wallsFolder then
    local walls = wallsFolder:GetChildren()
    local torchCount = 0
    
    -- 10å€‹ã”ã¨ã«æ¾æ˜ã‚’è¨­ç½®ï¼ˆé–“éš”ã‚’èª¿æ•´ï¼‰
    for i = 1, #walls, 10 do
        local wall = walls[i]
        if wall:IsA("Part") then
            -- å£ã®æ¨ªã«æ¾æ˜ã‚’è¨­ç½®
            local torchPos = wall.Position + Vector3.new(2.5, 0, 0)
            createTorch(torchPos, lightingFolder)
            torchCount = torchCount + 1
        end
    end
    
    print("ğŸ”¥ è¿·è·¯ã«æ¾æ˜ã‚’ " .. torchCount .. " å€‹è¨­ç½®ã—ã¾ã—ãŸ")
else
    warn("âŒ è¿·è·¯ã®å£ãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
end

-- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢ã«ç…§æ˜ã‚’è¿½åŠ 
local startArea = mazeGame:FindFirstChild("StartArea")
if startArea then
    -- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢ã®å››éš…ã«æ¾æ˜
    local startPositions = {
        Vector3.new(-35, 0, -105),  -- å·¦å‰
        Vector3.new(35, 0, -105),   -- å³å‰
        Vector3.new(-35, 0, -125),  -- å·¦å¥¥
        Vector3.new(35, 0, -125)    -- å³å¥¥
    }
    
    for _, pos in ipairs(startPositions) do
        createTorch(pos, lightingFolder)
    end
    
    -- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢ä¸­å¤®ã«ã‚­ãƒ£ãƒ³ãƒ—ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼
    createCampfire(Vector3.new(-10, 0, -115), lightingFolder)
    createCampfire(Vector3.new(10, 0, -115), lightingFolder)
    
    print("ğŸ”¥ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢ã«æ¾æ˜4å€‹ã€ã‚­ãƒ£ãƒ³ãƒ—ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼2å€‹ã‚’è¨­ç½®ã—ã¾ã—ãŸ")
else
    warn("âŒ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¨ãƒªã‚¢ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
end

-- ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ã«ç…§æ˜ã‚’è¿½åŠ 
local goalArea = mazeGame:FindFirstChild("GoalArea")
if goalArea then
    -- ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ã®å››éš…ã«æ¾æ˜
    local goalPositions = {
        Vector3.new(-25, 0, 85),   -- å·¦å‰
        Vector3.new(25, 0, 85),    -- å³å‰
        Vector3.new(-25, 0, 125),  -- å·¦å¥¥
        Vector3.new(25, 0, 125)    -- å³å¥¥
    }
    
    for _, pos in ipairs(goalPositions) do
        createTorch(pos, lightingFolder)
    end
    
    -- ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ä¸­å¤®ã«ã‚­ãƒ£ãƒ³ãƒ—ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼
    createCampfire(Vector3.new(-10, 0, 105), lightingFolder)
    createCampfire(Vector3.new(10, 0, 105), lightingFolder)
    
    print("ğŸ”¥ ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ã«æ¾æ˜4å€‹ã€ã‚­ãƒ£ãƒ³ãƒ—ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼2å€‹ã‚’è¨­ç½®ã—ã¾ã—ãŸ")
else
    warn("âŒ ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
end

-- å¤©äº•ã®ä¸€éƒ¨ã«æ˜ã‹ã‚Šå–ã‚Šç”¨ã®éš™é–“ã‚’ä½œæˆ
local ceilingFolder = mazeGame:FindFirstChild("Ceiling")
if ceilingFolder then
    local ceilings = ceilingFolder:GetChildren()
    
    -- 20å€‹ã”ã¨ã«å¤©äº•ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‰Šé™¤ã—ã¦æ˜ã‹ã‚Šå–ã‚Šã‚’ä½œã‚‹
    for i = 1, #ceilings, 20 do
        local ceiling = ceilings[i]
        if ceiling:IsA("Part") then
            ceiling:Destroy()
        end
    end
    
    print("ğŸ’¡ å¤©äº•ã«æ˜ã‹ã‚Šå–ã‚Šã®éš™é–“ã‚’ä½œæˆã—ã¾ã—ãŸ")
end

-- ç’°å¢ƒå…‰ã®èª¿æ•´
local lighting = game:GetService("Lighting")
lighting.Ambient = Color3.new(0.2, 0.2, 0.3)  -- å°‘ã—æ˜ã‚‹ãã™ã‚‹
lighting.Brightness = 1.5
lighting.OutdoorAmbient = Color3.new(0.3, 0.3, 0.4)

print("âœ… è¿·è·¯ç…§æ˜ã‚·ã‚¹ãƒ†ãƒ ã®è¨­ç½®å®Œäº†ï¼")
print("ğŸ”¥ æ¾æ˜: è¿·è·¯å†… + ã‚¹ã‚¿ãƒ¼ãƒˆãƒ»ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢å„4å€‹")
print("ğŸ”¥ ã‚­ãƒ£ãƒ³ãƒ—ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼: ã‚¹ã‚¿ãƒ¼ãƒˆãƒ»ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢å„2å€‹")
print("ğŸ’¡ å¤©äº•ã«æ˜ã‹ã‚Šå–ã‚Šã®éš™é–“è¿½åŠ ")
print("ğŸŒ… ç’°å¢ƒå…‰ã‚’èª¿æ•´ã—ã¦å…¨ä½“ã‚’æ˜ã‚‹ãã—ã¾ã—ãŸ")
print("")
print("ğŸ® è¿·è·¯ãŒæ˜ã‚‹ãå¿«é©ã«ãªã‚Šã¾ã—ãŸï¼")