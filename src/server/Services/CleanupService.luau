-- Kanata Maze ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚µãƒ¼ãƒ“ã‚¹
local CleanupService = {}

local workspace = game:GetService("Workspace")

-- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—åˆæœŸåŒ–ãƒ•ãƒ©ã‚°
local cleanupInitialized = false

-- ä¸è¦ãªã‚µã‚¤ãƒ³ãƒœãƒ¼ãƒ‰å‰Šé™¤ã‚·ã‚¹ãƒ†ãƒ 
local function cleanupUnwantedSigns(mazeGame)
    -- å‰Šé™¤å¯¾è±¡ã®ã‚¢ã‚¤ãƒ†ãƒ 
    local itemsToDelete = {
        "CelebrationArch",        -- Congratulationsã‚¢ãƒ¼ãƒ
        "GoalEntranceSign",       -- ã‚²ãƒ¼ãƒˆå…ˆã®ã‚µã‚¤ãƒ³
        "RankingSign",           -- ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒœãƒ¼ãƒ‰ã®ã‚µã‚¤ãƒ³
        "WarpDirectionSign"      -- ãƒ¯ãƒ¼ãƒ—æ–¹å‘ã‚µã‚¤ãƒ³
    }
    
    local deletedCount = 0
    
    -- æŒ‡å®šã•ã‚ŒãŸã‚¢ã‚¤ãƒ†ãƒ ã‚’å‰Šé™¤
    for _, itemName in ipairs(itemsToDelete) do
        local item = mazeGame:FindFirstChild(itemName)
        if item then
            item:Destroy()
            deletedCount = deletedCount + 1
            print("ğŸ—‘ï¸ " .. itemName .. " ã‚’å‰Šé™¤ã—ã¾ã—ãŸ")
        end
    end
    
    -- è¿½åŠ ã§ã€åå‰ã«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ¤œç´¢ã—ã¦å‰Šé™¤
    local keywords = {"congratulations", "celebration", "entrance"}
    
    for _, child in pairs(mazeGame:GetChildren()) do
        if child:IsA("Part") then
            local name = string.lower(child.Name)
            for _, keyword in ipairs(keywords) do
                if string.find(name, keyword) then
                    child:Destroy()
                    deletedCount = deletedCount + 1
                    print("ğŸ—‘ï¸ " .. child.Name .. " ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒï¼‰")
                    break
                end
            end
        end
    end
    
    -- GoalAreaãƒ•ã‚©ãƒ«ãƒ€å†…ã‚‚ãƒã‚§ãƒƒã‚¯
    local goalArea = mazeGame:FindFirstChild("GoalArea")
    if goalArea then
        for _, child in pairs(goalArea:GetChildren()) do
            if child:IsA("Part") then
                local name = string.lower(child.Name)
                for _, keyword in ipairs(keywords) do
                    if string.find(name, keyword) then
                        child:Destroy()
                        deletedCount = deletedCount + 1
                        print("ğŸ—‘ï¸ " .. child.Name .. " ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼ˆGoalAreaå†…ï¼‰")
                        break
                    end
                end
            end
        end
    end
    
    print("ğŸ§¹ ä¸è¦ãªã‚µã‚¤ãƒ³ãƒœãƒ¼ãƒ‰ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†: " .. deletedCount .. " å€‹å‰Šé™¤")
end

-- ãƒ¡ã‚¤ãƒ³åˆæœŸåŒ–é–¢æ•°
function CleanupService.Initialize()
    if cleanupInitialized then
        return
    end
    
    print("ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆæœŸåŒ–ä¸­...")
    
    -- MazeGameã®å¾…æ©Ÿ
    local mazeGame = workspace:WaitForChild("MazeGame", 30)
    if not mazeGame then
        warn("âŒ MazeGameãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        return
    end
    
    -- ä¸è¦ãªã‚µã‚¤ãƒ³ãƒœãƒ¼ãƒ‰å‰Šé™¤
    cleanupUnwantedSigns(mazeGame)
    
    cleanupInitialized = true
    print("âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚µãƒ¼ãƒ“ã‚¹ã®åˆæœŸåŒ–å®Œäº†ï¼")
end

-- ã‚µãƒ¼ãƒ“ã‚¹é–‹å§‹
function CleanupService.Start()
    spawn(function()
        wait(7) -- ä»–ã®å…¨ã‚·ã‚¹ãƒ†ãƒ ã®å¾Œã«å®Ÿè¡Œ
        CleanupService.Initialize()
    end)
end

return CleanupService