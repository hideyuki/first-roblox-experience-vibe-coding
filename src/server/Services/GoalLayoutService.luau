-- Kanata Maze ã‚´ãƒ¼ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚µãƒ¼ãƒ“ã‚¹
local GoalLayoutService = {}

local workspace = game:GetService("Workspace")

-- ã‚´ãƒ¼ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåˆæœŸåŒ–ãƒ•ãƒ©ã‚°
local goalLayoutInitialized = false

-- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿®æ­£ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰
local function buildGoalLayoutSystem(mazeGame)
    -- æ—¢å­˜ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å‰Šé™¤
    local itemsToRemove = {
        "CelebrationArch", "RankingPedestal", "WarpArea", 
        "GoalEntranceSign", "RankingSign", "WarpDirectionSign"
    }
    
    for _, itemName in ipairs(itemsToRemove) do
        local item = mazeGame:FindFirstChild(itemName)
        if item then
            item:Destroy()
        end
    end
    
    -- 1. Congratulationsã‚¢ãƒ¼ãƒå‰Šé™¤ï¼ˆè¦æ±‚ã«ã‚ˆã‚Šï¼‰
    
    -- 2. ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒœãƒ¼ãƒ‰å°åº§ï¼ˆå³å´ï¼‰
    local rankingPedestal = Instance.new("Part")
    rankingPedestal.Name = "RankingPedestal"
    rankingPedestal.Size = Vector3.new(22, 2, 4)
    rankingPedestal.Position = Vector3.new(20, 1, 135)  -- å³å´
    rankingPedestal.Anchored = true
    rankingPedestal.Material = Enum.Material.Marble
    rankingPedestal.BrickColor = BrickColor.new("Institutional white")
    rankingPedestal.Parent = mazeGame
    
    -- 3. ãƒ¯ãƒ¼ãƒ—ã‚¨ãƒªã‚¢ã®åºŠãƒãƒ¼ã‚­ãƒ³ã‚°ï¼ˆå·¦å´ï¼‰
    local warpArea = Instance.new("Part")
    warpArea.Name = "WarpArea"
    warpArea.Size = Vector3.new(18, 0.1, 18)
    warpArea.Position = Vector3.new(-20, 0.55, 135)  -- å·¦å´
    warpArea.Anchored = true
    warpArea.Material = Enum.Material.Neon
    warpArea.BrickColor = BrickColor.new("Bright blue")
    warpArea.Transparency = 0.7
    warpArea.Parent = mazeGame
    
    -- 4. ã‚¨ãƒªã‚¢æ¡ˆå†…æ¨™è­˜å‰Šé™¤ï¼ˆè¦æ±‚ã«ã‚ˆã‚Šï¼‰
    
    print("ğŸ¨ ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ä¿®æ­£ã—ã¾ã—ãŸ")
end

-- ãƒ¡ã‚¤ãƒ³åˆæœŸåŒ–é–¢æ•°
function GoalLayoutService.Initialize()
    if goalLayoutInitialized then
        return
    end
    
    print("ğŸ¨ ã‚´ãƒ¼ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆæœŸåŒ–ä¸­...")
    
    -- MazeGameã®å¾…æ©Ÿ
    local mazeGame = workspace:WaitForChild("MazeGame", 30)
    if not mazeGame then
        warn("âŒ MazeGameãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        return
    end
    
    -- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿®æ­£ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰
    buildGoalLayoutSystem(mazeGame)
    
    goalLayoutInitialized = true
    print("âœ… ã‚´ãƒ¼ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã®åˆæœŸåŒ–å®Œäº†ï¼")
end

-- ã‚µãƒ¼ãƒ“ã‚¹é–‹å§‹
function GoalLayoutService.Start()
    spawn(function()
        wait(2) -- ã‚´ãƒ¼ãƒ«ã‚¨ãƒªã‚¢æ§‹ç¯‰ã®å¾Œã«å®Ÿè¡Œ
        GoalLayoutService.Initialize()
    end)
end

return GoalLayoutService