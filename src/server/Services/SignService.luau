-- Kanata Maze ã‚µã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆä½ç½®ä¿®æ­£ç‰ˆï¼‰
local SignService = {}

local workspace = game:GetService("Workspace")

-- ã‚µã‚¤ãƒ³åˆæœŸåŒ–ãƒ•ãƒ©ã‚°
local signSystemInitialized = false

-- ã‚´ãƒ¼ãƒ«ã‚µã‚¤ãƒ³ä¿®æ­£
local function fixGoalSignPosition(mazeGame)
    -- æ—¢å­˜ã®ã‚´ãƒ¼ãƒ«ã‚µã‚¤ãƒ³ã‚’å‰Šé™¤
    local existingGoalSign = mazeGame:FindFirstChild("GoalSign")
    if existingGoalSign then
        existingGoalSign:Destroy()
        print("ğŸ—‘ï¸ å¤ã„ã‚´ãƒ¼ãƒ«ã‚µã‚¤ãƒ³ã‚’å‰Šé™¤ã—ã¾ã—ãŸ")
    end
    
    -- æ­£ã—ã„ä½ç½®ã«æ–°ã—ã„ã‚´ãƒ¼ãƒ«ã‚µã‚¤ãƒ³ã‚’ä½œæˆ
    local goalSign = Instance.new("Part")
    goalSign.Name = "GoalSign"
    goalSign.Size = Vector3.new(8, 3, 0.5)
    goalSign.Position = Vector3.new(0, 12, 75)  -- ã‚´ãƒ¼ãƒ«ã‚²ãƒ¼ãƒˆä¸Šã«é…ç½®ï¼ˆz=73ã®å°‘ã—å¾Œã‚ï¼‰
    goalSign.Anchored = true
    goalSign.Material = Enum.Material.SmoothPlastic
    goalSign.BrickColor = BrickColor.new("Bright red")
    goalSign.Parent = mazeGame
    
    -- ã‚µã‚¤ãƒ³ã®GUI
    local goalGui = Instance.new("SurfaceGui")
    goalGui.Name = "GoalGui"
    goalGui.Face = Enum.NormalId.Front
    goalGui.Parent = goalSign
    
    local goalLabel = Instance.new("TextLabel")
    goalLabel.Name = "GoalLabel"
    goalLabel.Size = UDim2.new(1, 0, 1, 0)
    goalLabel.BackgroundTransparency = 1
    goalLabel.Text = "ğŸ† GOAL ğŸ†"
    goalLabel.TextColor3 = Color3.new(1, 1, 1)
    goalLabel.TextScaled = true
    goalLabel.Font = Enum.Font.SourceSansBold
    goalLabel.Parent = goalGui
    
    print("ğŸ† ã‚´ãƒ¼ãƒ«ã‚µã‚¤ãƒ³ã‚’æ­£ã—ã„ä½ç½®ã«é…ç½®ã—ã¾ã—ãŸï¼ˆz=75, ã‚´ãƒ¼ãƒ«ã‚²ãƒ¼ãƒˆä¸Šï¼‰")
    return goalSign
end

-- ã‚¹ã‚¿ãƒ¼ãƒˆã‚µã‚¤ãƒ³ä¿®æ­£ï¼ˆå¿µã®ãŸã‚ï¼‰
local function fixStartSignPosition(mazeGame)
    -- æ—¢å­˜ã®ã‚¹ã‚¿ãƒ¼ãƒˆã‚µã‚¤ãƒ³ã‚’å‰Šé™¤
    local existingStartSign = mazeGame:FindFirstChild("StartSign")
    if existingStartSign then
        existingStartSign:Destroy()
        print("ğŸ—‘ï¸ å¤ã„ã‚¹ã‚¿ãƒ¼ãƒˆã‚µã‚¤ãƒ³ã‚’å‰Šé™¤ã—ã¾ã—ãŸ")
    end
    
    -- æ­£ã—ã„ä½ç½®ã«æ–°ã—ã„ã‚¹ã‚¿ãƒ¼ãƒˆã‚µã‚¤ãƒ³ã‚’ä½œæˆ
    local startSign = Instance.new("Part")
    startSign.Name = "StartSign"
    startSign.Size = Vector3.new(8, 3, 0.5)
    startSign.Position = Vector3.new(0, 12, -75)  -- ã‚¹ã‚¿ãƒ¼ãƒˆã‚²ãƒ¼ãƒˆä¸Šã«é…ç½®ï¼ˆz=-73ã®å°‘ã—å‰ï¼‰
    startSign.Anchored = true
    startSign.Material = Enum.Material.SmoothPlastic
    startSign.BrickColor = BrickColor.new("Bright blue")
    startSign.Parent = mazeGame
    
    -- ã‚µã‚¤ãƒ³ã®GUI
    local startGui = Instance.new("SurfaceGui")
    startGui.Name = "StartGui"
    startGui.Face = Enum.NormalId.Front
    startGui.Parent = startSign
    
    local startLabel = Instance.new("TextLabel")
    startLabel.Name = "StartLabel"
    startLabel.Size = UDim2.new(1, 0, 1, 0)
    startLabel.BackgroundTransparency = 1
    startLabel.Text = "ğŸš€ START MAZE ğŸš€"
    startLabel.TextColor3 = Color3.new(1, 1, 1)
    startLabel.TextScaled = true
    startLabel.Font = Enum.Font.SourceSansBold
    startLabel.Parent = startGui
    
    print("ğŸš€ ã‚¹ã‚¿ãƒ¼ãƒˆã‚µã‚¤ãƒ³ã‚’æ­£ã—ã„ä½ç½®ã«é…ç½®ã—ã¾ã—ãŸï¼ˆz=-75, ã‚¹ã‚¿ãƒ¼ãƒˆã‚²ãƒ¼ãƒˆä¸Šï¼‰")
    return startSign
end

-- ãƒ¡ã‚¤ãƒ³åˆæœŸåŒ–é–¢æ•°
function SignService.Initialize()
    if signSystemInitialized then
        return
    end
    
    print("ğŸ·ï¸ ã‚µã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆæœŸåŒ–ä¸­...")
    
    -- MazeGameã®å¾…æ©Ÿ
    local mazeGame = workspace:WaitForChild("MazeGame", 30)
    if not mazeGame then
        warn("âŒ MazeGameãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        return
    end
    
    -- ã‚µã‚¤ãƒ³ä½ç½®ä¿®æ­£
    fixGoalSignPosition(mazeGame)
    fixStartSignPosition(mazeGame)
    
    signSystemInitialized = true
    print("âœ… ã‚µã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®åˆæœŸåŒ–å®Œäº†ï¼")
end

-- ã‚µãƒ¼ãƒ“ã‚¹é–‹å§‹
function SignService.Start()
    spawn(function()
        wait(3) -- ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã®å¾Œã«å®Ÿè¡Œ
        SignService.Initialize()
    end)
end

return SignService