-- Kanata Maze ãƒ¯ãƒ¼ãƒ—ã‚·ã‚¹ãƒ†ãƒ è¨­ç½®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
print("ğŸŒ€ ãƒ¯ãƒ¼ãƒ—ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­ç½®ä¸­...")

local workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")

-- MazeGameãƒ•ã‚©ãƒ«ãƒ€ã®å–å¾—
local mazeGame = workspace:FindFirstChild("MazeGame")
if not mazeGame then
    warn("âŒ MazeGameãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
    return
end

-- ãƒ¯ãƒ¼ãƒ—ã‚¾ãƒ¼ãƒ³ãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ
local warpFolder = mazeGame:FindFirstChild("WarpSystem")
if warpFolder then
    warpFolder:Destroy()
end
warpFolder = Instance.new("Folder")
warpFolder.Name = "WarpSystem"
warpFolder.Parent = mazeGame

-- ãƒ¯ãƒ¼ãƒ—ã‚¾ãƒ¼ãƒ³ã®è¨­å®šï¼ˆConstants.luauã‹ã‚‰ï¼‰
local WARP_ZONE_SIZE = Vector3.new(12, 1, 12)
local WARP_ZONE_POSITION = Vector3.new(0, 0, 115)

-- ãƒ¯ãƒ¼ãƒ—ã‚¾ãƒ¼ãƒ³ã®ãƒ™ãƒ¼ã‚¹ï¼ˆå®Ÿéš›ã®å½“ãŸã‚Šåˆ¤å®šï¼‰
local warpBase = Instance.new("Part")
warpBase.Name = "WarpZone"
warpBase.Size = WARP_ZONE_SIZE
warpBase.Position = WARP_ZONE_POSITION + Vector3.new(0, 0.5, 0)
warpBase.Anchored = true
warpBase.CanCollide = false  -- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒé€šã‚ŠæŠœã‘ã‚‰ã‚Œã‚‹
warpBase.Material = Enum.Material.ForceField
warpBase.BrickColor = BrickColor.new("Bright blue")
warpBase.Transparency = 0.3
warpBase.Parent = warpFolder

-- ãƒ¯ãƒ¼ãƒ—ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®è¦–è¦šçš„è¦ç´ 
local function createWarpEffect(parent, position, size)
    -- å…‰ã‚‹å¢ƒç•Œç·š
    for i = 1, 8 do
        local angle = (i - 1) * (math.pi * 2 / 8)
        local radius = size.X / 2 + 1
        
        local beacon = Instance.new("Part")
        beacon.Name = "WarpBeacon" .. i
        beacon.Size = Vector3.new(0.5, 3, 0.5)
        beacon.Position = position + Vector3.new(
            math.cos(angle) * radius,
            1.5,
            math.sin(angle) * radius
        )
        beacon.Anchored = true
        beacon.CanCollide = false
        beacon.Material = Enum.Material.Neon
        beacon.BrickColor = BrickColor.new("Cyan")
        beacon.Shape = Enum.PartType.Cylinder
        beacon.Rotation = Vector3.new(0, 0, 90)
        beacon.Parent = parent
        
        -- ãƒ“ãƒ¼ã‚³ãƒ³ã®å…‰æº
        local pointLight = Instance.new("PointLight")
        pointLight.Color = Color3.new(0, 1, 1)  -- ã‚·ã‚¢ãƒ³è‰²
        pointLight.Brightness = 2
        pointLight.Range = 15
        pointLight.Parent = beacon
        
        -- å›è»¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        spawn(function()
            while beacon.Parent do
                local tween = TweenService:Create(
                    beacon,
                    TweenInfo.new(2, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1),
                    {Rotation = Vector3.new(0, 360, 90)}
                )
                tween:Play()
                wait(2)
            end
        end)
        
        -- æ˜æ»…ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        spawn(function()
            while beacon.Parent do
                local targetBrightness = math.random(15, 25) / 10
                local tween = TweenService:Create(
                    pointLight,
                    TweenInfo.new(0.8, Enum.EasingStyle.Sine),
                    {Brightness = targetBrightness}
                )
                tween:Play()
                wait(0.8)
            end
        end)
    end
end

-- ãƒ¯ãƒ¼ãƒ—ãƒãƒ¼ã‚¿ãƒ«ã®è¦–è¦šã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
local portalEffect = Instance.new("Part")
portalEffect.Name = "PortalEffect"
portalEffect.Size = Vector3.new(10, 0.2, 10)
portalEffect.Position = WARP_ZONE_POSITION + Vector3.new(0, 0.1, 0)
portalEffect.Anchored = true
portalEffect.CanCollide = false
portalEffect.Material = Enum.Material.Neon
portalEffect.BrickColor = BrickColor.new("Bright blue")
portalEffect.Transparency = 0.5
portalEffect.Shape = Enum.PartType.Cylinder
portalEffect.Rotation = Vector3.new(0, 0, 90)
portalEffect.Parent = warpFolder

-- ãƒãƒ¼ã‚¿ãƒ«ã®å›è»¢ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
spawn(function()
    while portalEffect.Parent do
        local tween = TweenService:Create(
            portalEffect,
            TweenInfo.new(3, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1),
            {Rotation = Vector3.new(0, 360, 90)}
        )
        tween:Play()
        wait(3)
    end
end)

-- ãƒ¯ãƒ¼ãƒ—ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®è¨­ç½®
createWarpEffect(warpFolder, WARP_ZONE_POSITION, WARP_ZONE_SIZE)

-- ãƒ¯ãƒ¼ãƒ—ã‚¾ãƒ¼ãƒ³ã®ã‚µã‚¤ãƒ³
local warpSign = Instance.new("Part")
warpSign.Name = "WarpSign"
warpSign.Size = Vector3.new(8, 4, 0.5)
warpSign.Position = WARP_ZONE_POSITION + Vector3.new(0, 8, -8)
warpSign.Anchored = true
warpSign.Material = Enum.Material.SmoothPlastic
warpSign.BrickColor = BrickColor.new("Bright blue")
warpSign.Parent = warpFolder

-- ã‚µã‚¤ãƒ³ã®GUI
local warpGui = Instance.new("SurfaceGui")
warpGui.Name = "WarpGui"
warpGui.Face = Enum.NormalId.Front
warpGui.Parent = warpSign

local warpLabel = Instance.new("TextLabel")
warpLabel.Name = "WarpLabel"
warpLabel.Size = UDim2.new(1, 0, 0.6, 0)
warpLabel.Position = UDim2.new(0, 0, 0, 0)
warpLabel.BackgroundTransparency = 1
warpLabel.Text = "ğŸŒ€ WARP TO START ğŸŒ€"
warpLabel.TextColor3 = Color3.new(1, 1, 1)
warpLabel.TextScaled = true
warpLabel.Font = Enum.Font.SourceSansBold
warpLabel.Parent = warpGui

local instructionLabel = Instance.new("TextLabel")
instructionLabel.Name = "InstructionLabel"
instructionLabel.Size = UDim2.new(1, 0, 0.4, 0)
instructionLabel.Position = UDim2.new(0, 0, 0.6, 0)
instructionLabel.BackgroundTransparency = 1
instructionLabel.Text = "Step into the blue zone to teleport!"
instructionLabel.TextColor3 = Color3.new(0.8, 0.8, 1)
warpLabel.TextScaled = true
instructionLabel.Font = Enum.Font.SourceSans
instructionLabel.Parent = warpGui

-- ã‚µã‚¤ãƒ³ã®å…‰æº
local signLight = Instance.new("PointLight")
signLight.Color = Color3.new(0, 0.8, 1)
signLight.Brightness = 1.5
signLight.Range = 20
signLight.Parent = warpSign

print("âœ… ãƒ¯ãƒ¼ãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®ç‰©ç†æ§‹é€ ã‚’è¨­ç½®å®Œäº†ï¼")
print("ğŸŒ€ ãƒ¯ãƒ¼ãƒ—ã‚¾ãƒ¼ãƒ³: " .. tostring(WARP_ZONE_POSITION))
print("ğŸ“ ã‚µã‚¤ã‚º: " .. tostring(WARP_ZONE_SIZE))
print("ğŸ¯ ãƒ“ãƒ¼ã‚³ãƒ³: 8å€‹ã®å…‰ã‚‹å¢ƒç•Œç·š")
print("ğŸ’« ãƒãƒ¼ã‚¿ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ: å›è»¢ã™ã‚‹é’ã„å††ç›¤")
print("ğŸ·ï¸ ã‚µã‚¤ãƒ³: ä½¿ç”¨æ–¹æ³•ã®è¡¨ç¤º")
print("")
print("âš ï¸ æ¬¡ã«å¿…è¦: ã‚µãƒ¼ãƒãƒ¼å´ã®ãƒ†ãƒ¬ãƒãƒ¼ãƒˆãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…")
print("ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«: src/server/init.server.luau ã«ãƒ¯ãƒ¼ãƒ—æ¤œå‡ºã‚’è¿½åŠ ã—ã¦ãã ã•ã„")